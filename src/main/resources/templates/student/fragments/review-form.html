<!-- Fragment: Review Form untuk Course Detail -->
<!-- Include di dalam tab reviews, setelah rating-overview -->

<th:block th:fragment="review-form">
    <!-- Review Form (hanya untuk yang sudah enroll dan belum review) -->
    <div th:if="${isEnrolled and !hasReviewed}" class="review-form-section">
        <h3 class="review-form-title">Tulis Ulasan Kamu</h3>
        <form th:action="@{/courses/{slug}/review(slug=${course.slug})}" method="post" class="review-form" id="reviewForm">
            <input type="hidden" name="courseId" th:value="${course.courseId}">
            
            <!-- Star Rating Input -->
            <div class="form-group">
                <label class="form-label">Rating</label>
                <div class="star-rating-input" id="starRatingInput">
                    <input type="hidden" name="rating" id="ratingValue" value="0" required>
                    <button type="button" class="star-btn" data-value="1">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </button>
                    <button type="button" class="star-btn" data-value="2">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </button>
                    <button type="button" class="star-btn" data-value="3">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </button>
                    <button type="button" class="star-btn" data-value="4">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </button>
                    <button type="button" class="star-btn" data-value="5">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </button>
                    <span class="rating-text" id="ratingText">Pilih rating</span>
                </div>
            </div>
            
            <!-- Comment Input -->
            <div class="form-group">
                <label class="form-label" for="reviewComment">Ulasan</label>
                <textarea 
                    name="comment" 
                    id="reviewComment" 
                    class="form-textarea" 
                    rows="4" 
                    placeholder="Ceritakan pengalaman belajar kamu di kursus ini..."
                    required
                    minlength="20"
                    maxlength="1000"></textarea>
                <div class="form-hint">
                    <span id="charCount">0</span>/1000 karakter (minimal 20)
                </div>
            </div>
            
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary btn-submit-review" id="btnSubmitReview" disabled>
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"/>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                </svg>
                Kirim Ulasan
            </button>
        </form>
    </div>
    
    <!-- Already Reviewed Message -->
    <div th:if="${isEnrolled and hasReviewed}" class="review-info-message success">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
        <span>Kamu sudah memberikan ulasan untuk kursus ini</span>
    </div>
    
    <!-- Not Enrolled Message -->
    <div th:if="${!isEnrolled}" class="review-info-message info">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <span>Enroll kursus ini untuk dapat memberikan ulasan</span>
    </div>
</th:block>

<!-- CSS untuk Review Form (tambahkan ke <style> di course-detail.html) -->
<!--
.review-form-section {
    background: var(--color-bg-subtle);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.review-form-title {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 1.25rem;
    color: var(--color-text);
}

.review-form { display: flex; flex-direction: column; gap: 1.25rem; }
.form-group { display: flex; flex-direction: column; gap: .5rem; }
.form-label { font-size: .875rem; font-weight: 600; color: var(--color-text); }
.star-rating-input { display: flex; align-items: center; gap: .25rem; }

.star-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: .25rem;
    color: var(--color-border);
    transition: var(--transition);
}

.star-btn:hover, .star-btn.active { color: var(--color-star); }
.rating-text { margin-left: .75rem; font-size: .875rem; color: var(--color-text-muted); }

.form-textarea {
    width: 100%;
    padding: .875rem 1rem;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    font-size: .9375rem;
    font-family: inherit;
    line-height: 1.6;
    resize: vertical;
    min-height: 120px;
    transition: var(--transition);
}

.form-textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.1);
}

.form-textarea::placeholder { color: var(--color-text-muted); }
.form-hint { font-size: .8125rem; color: var(--color-text-muted); }
.btn-submit-review { align-self: flex-start; padding: .75rem 1.5rem; }
.btn-submit-review:disabled { background: var(--color-text-muted); cursor: not-allowed; }

.review-info-message {
    display: flex;
    align-items: center;
    gap: .75rem;
    padding: 1rem 1.25rem;
    border-radius: var(--radius-md);
    font-size: .9375rem;
    margin-bottom: 2rem;
}

.review-info-message.success {
    background: #ecfdf5;
    color: #065f46;
    border: 1px solid #a7f3d0;
}

.review-info-message.info {
    background: #eff6ff;
    color: #1e40af;
    border: 1px solid #bfdbfe;
}

.review-list-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 1.25rem;
    color: var(--color-text);
}

.review-empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--color-text-muted);
}

.review-empty-state svg { margin-bottom: 1rem; opacity: 0.5; }
.review-empty-state p { font-size: 1rem; margin-bottom: .5rem; }
.review-empty-state span { font-size: .875rem; }
-->

<!-- JavaScript untuk Review Form (tambahkan di akhir <script> di course-detail.html) -->
<!--
// Review Form Logic
(function() {
    var starBtns = document.querySelectorAll('.star-btn');
    var ratingValue = document.getElementById('ratingValue');
    var ratingText = document.getElementById('ratingText');
    var reviewComment = document.getElementById('reviewComment');
    var charCount = document.getElementById('charCount');
    var btnSubmit = document.getElementById('btnSubmitReview');
    
    if (!starBtns.length) return;
    
    var currentRating = 0;
    var ratingLabels = ['Pilih rating', 'Sangat Buruk', 'Buruk', 'Cukup', 'Bagus', 'Sangat Bagus'];
    
    // Star hover and click
    starBtns.forEach(function(btn) {
        var value = parseInt(btn.getAttribute('data-value'));
        
        btn.addEventListener('mouseenter', function() {
            highlightStars(value);
            ratingText.textContent = ratingLabels[value];
        });
        
        btn.addEventListener('mouseleave', function() {
            highlightStars(currentRating);
            ratingText.textContent = currentRating > 0 ? ratingLabels[currentRating] : 'Pilih rating';
        });
        
        btn.addEventListener('click', function() {
            currentRating = value;
            ratingValue.value = value;
            highlightStars(value);
            ratingText.textContent = ratingLabels[value];
            validateForm();
        });
    });
    
    function highlightStars(count) {
        starBtns.forEach(function(btn) {
            var val = parseInt(btn.getAttribute('data-value'));
            if (val <= count) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
    }
    
    if (reviewComment) {
        reviewComment.addEventListener('input', function() {
            var len = this.value.length;
            charCount.textContent = len;
            validateForm();
        });
    }
    
    function validateForm() {
        var rating = parseInt(ratingValue.value);
        var commentLen = reviewComment ? reviewComment.value.length : 0;
        
        if (rating > 0 && commentLen >= 20) {
            btnSubmit.disabled = false;
        } else {
            btnSubmit.disabled = true;
        }
    }
})();
-->